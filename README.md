# �� Outpilot

ChatGPTでの学びを「残す・整える・発信する」ためのAIアウトプット支援ツール＆ポートフォリオサイト。
調べたことを自動で記事やスライドに変換し、Qiitaや自ブログに投稿可能。

---

## 🎯 コンセプト

ChatGPTでの学びを**自動で記事やスライドに変換**し、**Qiitaや自ブログに投稿**できるAIアウトプットパートナー。
学習内容を資産化し、発信までつなげる自分専用のツール。

---

## 🗂️ サイト構成

| パス               | 内容                                                 | 公開範囲              |
| ------------------ | ---------------------------------------------------- | --------------------- |
| `/`                | ポートフォリオTOP（自己紹介・導線）                  | ✅ 公開               |
| `/articles`        | 投稿記事一覧（Qiita＋自ブログ）                      | ✅ 公開               |
| `/projects`        | 自作プロダクト・制作物一覧                           | ✅ 公開               |
| `/skills`          | タグ別記事数・月別アウトプット可視化                 | ✅ 公開               |
| `/slides`          | スライド一覧ページ                                   | ✅ 公開               |
| `/slides/[slug]`   | 個別スライド表示ページ（Marp形式）                   | ✅ 公開               |
| `/outpilot/chat`   | ChatGPT連携チャットUI（記事化/スライド化ボタン付き） | 🔒 非公開（認証必要） |
| `/outpilot/drafts` | 記事下書き一覧・編集・投稿                           | 🔒 非公開（認証必要） |

---

## ✅ 機能要件

### 1. **ChatUI（学習ログ）機能**

#### 1.1 基本チャット機能

- **入力**: ユーザーがメッセージを入力
- **送信**: ChatGPT（gpt-4o）に送信
- **応答**: AI応答を表示
- **履歴保存**: Prismaでチャット履歴をDBに保存

#### 1.2 スレッド機能（ChatGPT風）

- **新規スレッド作成**: タイトル入力で新規作成
- **スレッド一覧**: 左サイドバーにスレッド一覧表示
- **スレッド切り替え**: クリックでスレッド切り替え
- **スレッド削除**: 不要なスレッドを削除
- **メッセージ管理**: スレッド内の全メッセージを時系列表示

#### 1.3 記事化・スライド化ボタン

- **表示条件**: 各チャットログに個別ボタン
- **記事化ボタン**: そのログを基に記事生成
- **スライド化ボタン**: そのログを基にスライド生成

#### 1.4 UI/UX

- **レイアウト**: ChatGPT風の2カラムレイアウト
  - 左: スレッド一覧
  - 右: チャット画面
- **レスポンシブ**: モバイル対応
- **リアルタイム**: メッセージ送信中はローディング表示

### 2. **記事生成・投稿機能**

#### 2.1 完全自動記事生成

- **入力**: チャットログ全体または選択範囲
- **分析**: GPTが内容を分析
- **構成**: 自動で目次・構成を生成
- **執筆**: 完全自動で記事を執筆
- **最適化**: SEO対策、読みやすさを考慮

#### 2.2 生成内容

- **タイトル**: 魅力的なタイトルを自動生成
- **概要**: 記事の概要を自動生成
- **目次**: 論理的な構成の目次
- **本文**: 詳細で分かりやすい本文
- **タグ**: 適切なタグを自動付与

#### 2.3 投稿機能

- **Qiita投稿**: Qiita API経由で投稿
  - 下書き保存
  - 公開投稿
  - レート制限対応（1日100件、認証時1000回/時間）
- **自ブログ投稿**: Contentlayer + Markdownファイルで管理

#### 2.4 記事管理

- **下書き一覧**: 作成中の記事一覧
- **公開記事一覧**: 投稿済み記事一覧
- **編集機能**: 既存記事の編集
- **品質向上**: 複数回生成、人間チェック、テンプレート対応

### 3. **スライド生成・表示機能**

#### 3.1 GPT任せスライド生成

- **入力**: チャットログまたは手動入力
- **生成**: GPTでMarp形式Markdownを生成
- **枚数**: GPTが内容に応じて自動決定
- **構成**: 論理的な流れを自動構成
- **デザイン**: Marpテーマを自動選択

#### 3.2 生成内容

- **タイトルスライド**: プレゼンテーションタイトル
- **目次スライド**: スライド構成
- **内容スライド**: 詳細な内容
- **まとめスライド**: 要点のまとめ

#### 3.3 スライド表示

- **一覧表示**: `/slides`でスライド一覧
- **個別表示**: `/slides/[slug]`で個別スライド
- **Marp Viewer**: Web表示
- **PDF出力**: 将来的に対応予定
- **カスタマイズ**: テーマ、レイアウト調整

### 4. **スキル可視化機能**

#### 4.1 タグ別可視化

- **棒グラフ**: タグ別アウトプット数
- **円グラフ**: タグ別割合

#### 4.2 月別可視化

- **折れ線グラフ**: 月別アウトプット推移

#### 4.3 データソース

- **記事データ**: Qiita + 自ブログ
- **スライドデータ**: 生成したスライド
- **タグ抽出**: 記事・スライドから自動抽出

### 5. **ポートフォリオサイト機能**

#### 5.1 自己紹介ページ（`/`）

- **基本情報**: 名前、経歴、スキル
- **SNSリンク**: GitHub、Twitter、LinkedIn
- **導線**: 各機能へのナビゲーション

#### 5.2 記事一覧ページ（`/articles`）

- **統合表示**: Qiita + 自ブログ記事
- **フィルタリング**: タグ、日付、プラットフォーム
- **検索機能**: タイトル・内容検索

#### 5.3 プロジェクト一覧ページ（`/projects`）

- **制作物紹介**: 自作プロダクト一覧
- **詳細情報**: 技術スタック、説明、リンク

#### 5.4 スキルページ（`/skills`）

- **グラフ表示**: タグ別・月別アウトプット
- **統計情報**: 総記事数、総スライド数

### 6. **認証・認可機能**

#### 6.1 認証

- **NextAuth.js**: GitHub / Google認証
- **セッション管理**: JWTトークン

#### 6.2 認可制御

- **公開ページ**: 誰でもアクセス可能

  - `/` (ポートフォリオTOP)
  - `/articles` (記事一覧)
  - `/projects` (プロジェクト一覧)
  - `/skills` (スキル可視化)
  - `/slides` (スライド一覧)
  - `/slides/[slug]` (個別スライド)

- **非公開ページ**: 認証済みユーザーのみ
  - `/outpilot/chat` (チャットUI)
  - `/outpilot/drafts` (記事下書き)

#### 6.3 セキュリティ

- **CSRF対策**: NextAuth.jsのCSRF保護
- **XSS対策**: 入力値のサニタイズ
- **SQLインジェクション対策**: Prismaのパラメータ化クエリ

---

## 🧑‍💻 技術スタック

| 領域           | 技術                                                 |
| -------------- | ---------------------------------------------------- |
| フロントエンド | Next.js（App Router）+ Tailwind CSS                  |
| 状態管理       | Zustand or Context API                               |
| バックエンド   | NestJS（既存）                                       |
| DB / ORM       | PostgreSQL + Prisma                                  |
| 認証           | NextAuth.js (GitHub / Google)                        |
| AI連携         | OpenAI API（gpt-4o）                                 |
| 投稿連携       | Qiita API（v2）、自ブログ（Contentlayer + Markdown） |
| スライド表示   | Marp（@marp-team/marp-core）                         |

---

## 💡 ユースケース

| シーン          | できること                                           |
| --------------- | ---------------------------------------------------- |
| ChatGPTで調べた | チャット履歴保存、あとからボタンで記事化・スライド化 |
| 発信したい      | Qiitaや自ブログに投稿                                |
| 発表資料が必要  | GPTが生成したスライドを一覧・個別ページで閲覧可能    |
| 成長を見せたい  | スキルタグ別や月別のアウトプット量をグラフ化         |
| 自己紹介したい  | ポートフォリオで一元管理                             |

---

## 🔚 一言まとめ

outpilotは「学びを自動で整え、資産化し、発信までつなげる」自分専用のAIアウトプットパートナーです。

---

## 🚀 開発フェーズ

### ✅ **フェーズ 1：環境構築（完了）**

- [x] NestJS プロジェクト作成
- [x] Prisma 初期化・接続
- [x] PostgreSQL セットアップ
- [x] OpenAI API 統合

### 🔄 **フェーズ 2：Next.jsフロントエンド構築**

- [ ] Next.js プロジェクト作成
- [ ] Tailwind CSS 設定
- [ ] NextAuth.js 認証設定
- [ ] NestJS API との連携

### 📋 **フェーズ 3：チャット機能実装**

- [ ] ChatGPT風UI実装
- [ ] スレッド機能実装
- [ ] メッセージ送受信機能
- [ ] 記事化・スライド化ボタン

### ✍️ **フェーズ 4：記事生成機能**

- [ ] 完全自動記事生成
- [ ] Markdownエディタ
- [ ] Qiita API連携
- [ ] 自ブログ投稿機能

### 📊 **フェーズ 5：スライド生成機能**

- [ ] Marp形式スライド生成
- [ ] スライド表示機能
- [ ] スライド一覧ページ

### 📈 **フェーズ 6：ポートフォリオ機能**

- [ ] 自己紹介ページ
- [ ] 記事一覧ページ
- [ ] プロジェクト一覧ページ
- [ ] スキル可視化ページ

### 🧪 **フェーズ 7：テスト・デプロイ**

- [ ] ユニットテスト
- [ ] E2Eテスト
- [ ] 本番環境デプロイ
- [ ] パフォーマンス最適化

---

## 📝 API エンドポイント（NestJS）

### スレッド関連

- `POST /threads` - 新しいスレッドを作成
- `GET /threads` - スレッド一覧を取得
- `GET /threads/:id` - 特定のスレッドを取得
- `PATCH /threads/:id` - スレッドを更新
- `DELETE /threads/:id` - スレッドを削除

### メッセージ関連

- `POST /threads/:id/messages` - 新しいメッセージを送信（ChatGPT応答付き）
- `GET /threads/:id/messages` - スレッドのメッセージ一覧を取得
- `GET /threads/:threadId/messages/:messageId` - 特定のメッセージを取得

### 要約関連

- `POST /threads/:id/summaries` - スレッドの要約を作成
- `GET /threads/:id/summaries` - スレッドの要約一覧を取得
- `PATCH /threads/:threadId/summaries/:summaryId` - 要約を更新

### AI応答関連

- `POST /threads/:id/ai-response` - AI応答を生成

---

## 🔑 必要なAPIキー

### OpenAI API

1. OpenAI Platformにアクセス
2. APIキーを生成
3. 環境変数`OPENAI_API_KEY`に設定

### Qiita API

1. Qiitaにログイン
2. 個人用アクセストークンを生成
3. 環境変数`QIITA_API_TOKEN`に設定
4. レート制限に注意（認証時1000回/時間、1日100件投稿）

### Notion API（将来的に）

1. Notion Developersにアクセス
2. 新しいインテグレーションを作成
3. APIキーを取得し、環境変数`NOTION_API_KEY`に設定
4. データベースIDを取得し、環境変数`NOTION_DATABASE_ID`に設定

---

## 🚀 セットアップ

### 1. 依存関係のインストール

```bash
# バックエンド
pnpm install

# フロントエンド（今後作成予定）
cd frontend
pnpm install
```

### 2. 環境変数の設定

`.env`ファイルを作成し、以下の環境変数を設定してください：

```env
# OpenAI API
OPENAI_API_KEY=your_openai_api_key

# Qiita API
QIITA_API_TOKEN=your_qiita_api_token

# Database
DATABASE_URL="postgresql://username:password@localhost:5432/outpilot"

# NextAuth.js（今後追加予定）
NEXTAUTH_SECRET=your_nextauth_secret
GITHUB_ID=your_github_client_id
GITHUB_SECRET=your_github_client_secret
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
```

### 3. データベースのセットアップ

```bash
# Prismaクライアントの生成
npx prisma generate

# データベースのマイグレーション
npx prisma db push
```

### 4. 開発サーバーの起動

```bash
# バックエンド（開発モード）
pnpm run start:dev

# フロントエンド（今後追加予定）
cd frontend
pnpm run dev
```

---

## 📄 ライセンス

MIT License
